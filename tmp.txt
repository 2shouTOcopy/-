好，我按你“CCP 只保留控制标识 + SdkFeatureFlags”的要求，给出精确改动说明。你可以把下面内容直接放入设计/变更文档里。

⸻

CCP 寄存器变更说明（仅保留控制标识与特征标志）

1）变更摘要
	•	删除字段：用户名（16B）、密码（32B）、会话/任何与登录相关的内容。
	•	保留字段：
	•	ctrl_magic（4B）——控制/版本识别用
	•	sdk_feature_flags（4B）——SDK 特性声明
	•	寄存器总长度：8 字节（对齐/填充一律不需要；设备按 8B 精确解析）。
	•	职责调整：
	•	CCP 不参与鉴权、cookie 安装/替换。
	•	登录/鉴权严格走 INTERCHANGE + LOGIN；cookie 安装/续期/替换严格走独立请求（如 Write_reg(SessionCookieReg) 或 COOKIE_UPDATE_CMD）。

⸻

2）新寄存器定义

2.1 二进制布局

Offset  Size  Name              描述
0x00    4     ctrl_magic        控制标识（固定魔数/版本识别）
0x04    4     sdk_feature_flags SDK特征标志（见下）

	•	端序：小端（LE）。
	•	读写属性：R/W。
	•	上电默认值：
	•	ctrl_magic = 固定魔数（建议：0x43435001 // “CCP\1”）
	•	sdk_feature_flags = 0

2.2 结构体（示例）

#pragma pack(push, 1)
typedef struct {
    uint32_t ctrl_magic;        // 固定魔数，例如 0x43435001
    uint32_t sdk_feature_flags; // SdkFeatureFlags
} ccp_reg_t;
#pragma pack(pop)

typedef enum {
    FEATURE_FLAG_RANDOM_PORT = (1u << 0),
    FEATURE_FLAG_RESERVED_A  = (1u << 1),
    FEATURE_FLAG_RESERVED_B  = (1u << 2),
    // 仅表达SDK偏好，不触发协议内隐式动作
    FEATURE_FLAG_AUTO_RENEW  = (1u << 3),
} SdkFeatureFlags;

说明：FEATURE_FLAG_AUTO_RENEW 仅作偏好位，cookie 的安装/续期仍需 SDK 主动调用独立请求。

⸻

3）兼容与错误处理
	•	收到旧格式写入（>8B，例如 56B，且用户名/密码字段非零）
	•	设备直接返回：ERR_USE_NEW_LOGIN_FLOW（建议错误码 0xE101）。
	•	日志打印："CCP legacy payload detected, login moved to INTERCHANGE+LOGIN; cookie via COOKIE_UPDATE/Write_reg."
	•	收到长度 ≠ 8B 的写入
	•	设备返回：ERR_CCP_LENGTH_INVALID（建议 0xE102）。
	•	任何试图通过 CCP 进行登录/会话相关操作
	•	返回：ERR_CCP_UNSUPPORTED_OP（建议 0xE103）。
	•	读取 CCP
	•	返回当前 ctrl_magic 与 sdk_feature_flags（便于端到端确认）。

注：不要对旧字段“容错解析”或“静默忽略”，务必以显式错误码推动 SDK 升级，避免“看似成功但不生效”的隐患。

⸻

4）设备侧实现要点
	1.	解析器：严格按 8B 读取；超长/短直接报错（见上）。
	2.	幂等：重复写入相同 sdk_feature_flags 返回成功，设备内部不产生副作用。
	3.	安全边界：CCP 不触发任何鉴权、cookie 或通路互斥判定。
	4.	通路无关：3966（SC）/3956（ID）均可写 CCP（仅特性声明）。
	•	当 ID 通路关闭时，对 3956 的 CCP 写入建议同样不响应（保持“激活后ID关闭”一致策略）。若需允许读取/写入，可在文档中注明“CCP 例外开放”。默认推荐：随通路策略走（ID 关闭→不响应）。
	5.	日志：记录来源通路（端口）、flags 变更（旧→新）、时间戳。

⸻

5）SDK 侧改动清单（必须）
	•	移除：向 CCP 写用户名/密码/会话信息的逻辑。
	•	保留/更新：仅写 8B（ctrl_magic + sdk_feature_flags）。
	•	登录路径：走 INTERCHANGE + LOGIN；取 cookie 后，调用独立 cookie 请求安装/续期。
	•	错误处理：识别 ERR_USE_NEW_LOGIN_FLOW / ERR_CCP_LENGTH_INVALID / ERR_CCP_UNSUPPORTED_OP，弹出明确升级提示。
	•	自检：写入后读取 CCP 校验 flags 生效（可选）。

⸻

6）对流程/时序的影响（概要）

[旧] CCP(用户名+密码) -> 登录
   |
[新] INTERCHANGE -> LOGIN(返回cookie) -> COOKIE_UPDATE(独立请求)   // 完成会话安装
   |
   +--> CCP(可选)：仅写 sdk_feature_flags（8B，无会话含义）


⸻

7）文档补丁（可直接贴）
	•	1.1.4.5 登录（鉴权）：新增一句
“CCP 不用于登录；登录通过 INTERCHANGE+LOGIN 完成。cookie 的安装/更新仅通过独立请求完成（如 Write_reg(SessionCookieReg) 或 COOKIE_UPDATE_CMD）。”
	•	CCP 寄存器章节：替换为本页“新寄存器定义”，并添加“兼容与错误处理”小节。
	•	ID 通路策略：若保持“ID 关闭即不响应任何命令”，则 CCP 在 3956 同样不响应；如业务需要例外开放，需在《双通路鉴权机制》中注明“CCP 例外”。

⸻

这样修改后，登录链路与会话管理完全解耦，CCP 仅承担“特性声明/配置提示”角色，设备和 SDK 的改动都最小且清晰，兼容策略也可控。